{"remainingRequest":"/Users/qinxiaoxiong/AIDemo/AItoImage/hello-world/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/qinxiaoxiong/AIDemo/AItoImage/hello-world/src/components/Index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/qinxiaoxiong/AIDemo/AItoImage/hello-world/src/components/Index.vue","mtime":1684417176360},{"path":"/Users/qinxiaoxiong/AIDemo/AItoImage/hello-world/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/qinxiaoxiong/AIDemo/AItoImage/hello-world/node_modules/babel-loader/lib/index.js","mtime":456789000000},{"path":"/Users/qinxiaoxiong/AIDemo/AItoImage/hello-world/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/qinxiaoxiong/AIDemo/AItoImage/hello-world/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBhbm55YW5nIGZyb20gJ2FubnlhbmcnOwoKZXhwb3J0IGRlZmF1bHQgewogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICByZWNvZ25pemVkVGV4dDogJycsCiAgICAgIGltZ0xpc3Q6IFtdCiAgICB9OwogIH0sCiAgbWV0aG9kczogewogICAgc3RhcnRSZWNvZ25pdGlvbigpIHsKICAgICAgaWYgKGFubnlhbmcpIHsKICAgICAgICB0aGlzLmxvYWRJbWFnZXMoKQogICAgICAgIGFubnlhbmcuc3RhcnQoeyBhdXRvUmVzdGFydDogZmFsc2UsIGNvbnRpbnVvdXM6IGZhbHNlIH0pOwogICAgICAgIC8vIOiuvue9ruivhuWIq+ivreiogOS4uuS4reaWhwogICAgICAgIGFubnlhbmcuc2V0TGFuZ3VhZ2UoJ3poLUNOJyk7CgogICAgICAgIGFubnlhbmcuYWRkQ2FsbGJhY2soJ3Jlc3VsdCcsIChwaHJhc2VzKSA9PiB7CiAgICAgICAgICBjb25zb2xlLmxvZygncGhyYXNlcycsIHBocmFzZXMpCiAgICAgICAgICBpZiAocGhyYXNlcyAmJiBwaHJhc2VzLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgdGhpcy5yZWNvZ25pemVkVGV4dCA9IHBocmFzZXNbMF07CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5yZWNvZ25pemVkVGV4dCA9ICdXZWIgU3BlZWNoIEFQSSBub3Qgc3VwcG9ydGVkJzsKICAgICAgfQogICAgfSwKICAgIGxvYWRJbWFnZXMoKSB7CiAgICAgIGNvbnN0IGZvbGRlclBhdGggPSByZXF1aXJlLmNvbnRleHQoJy4uL2Fzc2V0cy9pbWFnZXMvcmVzdWx0JywgZmFsc2UsIC9cLihwbmd8anBlP2d8Z2lmfHN2ZykkLyk7CiAgICAgIGNvbnN0IGltYWdlcyA9IGZvbGRlclBhdGgua2V5cygpLm1hcCgoa2V5KSA9PiBmb2xkZXJQYXRoKGtleSkpOwogICAgICB0aGlzLmltZ0xpc3QgPSBpbWFnZXM7CiAgICAgIC8vIC8vIOacrOWcsOmdmeaAgeaWh+S7tuWkuei3r+W+hAogICAgICAvLyBjb25zdCBmb2xkZXJQYXRoID0gJy4uL2Fzc2V0cy9yZXN1bHQtbGlzdCc7CiAgICAgIC8vIC8vIOS9v+eUqHJlcXVpcmUuY29udGV4dOadpeWKqOaAgeWKoOi9veaWh+S7tuWkueS4i+eahOaJgOacieWbvueJhwogICAgICAvLyBjb25zdCBpbWFnZXMgPSByZXF1aXJlLmNvbnRleHQoZm9sZGVyUGF0aCwgZmFsc2UsIC9cLihwbmd8anBlP2d8Z2lmfHN2ZykkLyk7CiAgICAgIC8vIC8vIOmBjeWOhuWKoOi9veWbvueJh+W5tuWwhui3r+W+hOa3u+WKoOWIsGltYWdlc+aVsOe7hAogICAgICAvLyBpbWFnZXMua2V5cygpLmZvckVhY2goKGtleSkgPT4gewogICAgICAvLyAgIGNvbnN0IGltYWdlUGF0aCA9IGltYWdlcyhrZXkpOwogICAgICAvLyAgIHRoaXMuaW1nTGlzdC5wdXNoKGltYWdlUGF0aCk7CiAgICAgIC8vIH0pCiAgICAgIHRoaXMub2JzZXJ2ZUltYWdlcygpCiAgICB9LAogICAgb2JzZXJ2ZUltYWdlcygpIHsKICAgICAgY29uc3QgaW1hZ2VzID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcubGF6eS1pbWFnZScpKTsKCiAgICAgIGNvbnN0IG9ic2VydmVyID0gbmV3IEludGVyc2VjdGlvbk9ic2VydmVyKAogICAgICAgIChlbnRyaWVzKSA9PiB7CiAgICAgICAgICBlbnRyaWVzLmZvckVhY2goKGVudHJ5KSA9PiB7CiAgICAgICAgICAgIGlmIChlbnRyeS5pc0ludGVyc2VjdGluZykgewogICAgICAgICAgICAgIGNvbnN0IGltYWdlSW5kZXggPSBwYXJzZUludChlbnRyeS50YXJnZXQuZGF0YXNldC5pbmRleCk7CiAgICAgICAgICAgICAgdGhpcy5pbWdMaXN0W2ltYWdlSW5kZXhdLmlzVmlzaWJsZSA9IHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgcm9vdE1hcmdpbjogJzBweCcsCiAgICAgICAgICB0aHJlc2hvbGQ6IDAuMSwKICAgICAgICB9CiAgICAgICk7CgogICAgICBpbWFnZXMuZm9yRWFjaChpbWFnZSA9PiB7CiAgICAgICAgb2JzZXJ2ZXIub2JzZXJ2ZShpbWFnZSk7CiAgICAgICAgdGhpcy5pbWdMaXN0LnB1c2goewogICAgICAgICAgc3JjOiAnJywKICAgICAgICAgIGFsdDogJycsCiAgICAgICAgICBpc1Zpc2libGU6IGZhbHNlLAogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCiAgICBpbWFnZUxvYWRlZChpbmRleCkgewogICAgICBjb25zdCBpbWFnZSA9IHRoaXMuaW1nTGlzdFtpbmRleF07CiAgICAgIGltYWdlLnNyYyA9IGltYWdlLm9yaWdpbmFsU3JjOwogICAgICBpbWFnZS5hbHQgPSBpbWFnZS5vcmlnaW5hbEFsdDsKICAgIH0sCiAgfSwKICBiZWZvcmVEZXN0cm95KCkgewogICAgaWYgKGFubnlhbmcpIHsKICAgICAgYW5ueWFuZy5hYm9ydCgpOwogICAgfQogIH0sCn07Cg=="},{"version":3,"sources":["Index.vue"],"names":[],"mappings":";AAgBA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Index.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div>\n    <button @click=\"startRecognition\">开始识别</button>\n    <p>{{ recognizedText }}</p>\n    <ul class=\"flex-wrap img-box\">\n      <li v-for=\"item in imgList\" :key=\"item\">\n        <img\n          class=\"img-size\"\n          v-lazy=\"item\"\n        />\n      </li>\n    </ul>\n  </div>\n</template>\n\n<script>\nimport annyang from 'annyang';\n\nexport default {\n  data() {\n    return {\n      recognizedText: '',\n      imgList: []\n    };\n  },\n  methods: {\n    startRecognition() {\n      if (annyang) {\n        this.loadImages()\n        annyang.start({ autoRestart: false, continuous: false });\n        // 设置识别语言为中文\n        annyang.setLanguage('zh-CN');\n\n        annyang.addCallback('result', (phrases) => {\n          console.log('phrases', phrases)\n          if (phrases && phrases.length > 0) {\n            this.recognizedText = phrases[0];\n          }\n        });\n      } else {\n        this.recognizedText = 'Web Speech API not supported';\n      }\n    },\n    loadImages() {\n      const folderPath = require.context('../assets/images/result', false, /\\.(png|jpe?g|gif|svg)$/);\n      const images = folderPath.keys().map((key) => folderPath(key));\n      this.imgList = images;\n      // // 本地静态文件夹路径\n      // const folderPath = '../assets/result-list';\n      // // 使用require.context来动态加载文件夹下的所有图片\n      // const images = require.context(folderPath, false, /\\.(png|jpe?g|gif|svg)$/);\n      // // 遍历加载图片并将路径添加到images数组\n      // images.keys().forEach((key) => {\n      //   const imagePath = images(key);\n      //   this.imgList.push(imagePath);\n      // })\n      this.observeImages()\n    },\n    observeImages() {\n      const images = Array.from(document.querySelectorAll('.lazy-image'));\n\n      const observer = new IntersectionObserver(\n        (entries) => {\n          entries.forEach((entry) => {\n            if (entry.isIntersecting) {\n              const imageIndex = parseInt(entry.target.dataset.index);\n              this.imgList[imageIndex].isVisible = true;\n            }\n          });\n        },\n        {\n          rootMargin: '0px',\n          threshold: 0.1,\n        }\n      );\n\n      images.forEach(image => {\n        observer.observe(image);\n        this.imgList.push({\n          src: '',\n          alt: '',\n          isVisible: false,\n        });\n      });\n    },\n    imageLoaded(index) {\n      const image = this.imgList[index];\n      image.src = image.originalSrc;\n      image.alt = image.originalAlt;\n    },\n  },\n  beforeDestroy() {\n    if (annyang) {\n      annyang.abort();\n    }\n  },\n};\n</script>\n<style scoped>\n  .lazy-image {\n    opacity: 0;\n    transition: opacity 0.3s;\n  }\n  .lazy-image.is-visible {\n    opacity: 1;\n  }\n  .img-size {\n    width: 500px;\n    object-fit: contain;\n  }\n</style>\n"]}]}
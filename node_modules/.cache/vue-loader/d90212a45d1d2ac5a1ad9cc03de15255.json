{"remainingRequest":"/Users/qinxiaoxiong/AIDemo/AItoImage/hello-world/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/qinxiaoxiong/AIDemo/AItoImage/hello-world/src/components/Index.vue?vue&type=style&index=0&id=82b7485c&scoped=true&lang=css&","dependencies":[{"path":"/Users/qinxiaoxiong/AIDemo/AItoImage/hello-world/src/components/Index.vue","mtime":1684417176360},{"path":"/Users/qinxiaoxiong/AIDemo/AItoImage/hello-world/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/qinxiaoxiong/AIDemo/AItoImage/hello-world/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/qinxiaoxiong/AIDemo/AItoImage/hello-world/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/qinxiaoxiong/AIDemo/AItoImage/hello-world/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/qinxiaoxiong/AIDemo/AItoImage/hello-world/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci5sYXp5LWltYWdlIHsKICBvcGFjaXR5OiAwOwogIHRyYW5zaXRpb246IG9wYWNpdHkgMC4zczsKfQoubGF6eS1pbWFnZS5pcy12aXNpYmxlIHsKICBvcGFjaXR5OiAxOwp9Ci5pbWctc2l6ZSB7CiAgd2lkdGg6IDUwMHB4OwogIG9iamVjdC1maXQ6IGNvbnRhaW47Cn0K"},{"version":3,"sources":["Index.vue"],"names":[],"mappings":";AAgHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Index.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div>\n    <button @click=\"startRecognition\">开始识别</button>\n    <p>{{ recognizedText }}</p>\n    <ul class=\"flex-wrap img-box\">\n      <li v-for=\"item in imgList\" :key=\"item\">\n        <img\n          class=\"img-size\"\n          v-lazy=\"item\"\n        />\n      </li>\n    </ul>\n  </div>\n</template>\n\n<script>\nimport annyang from 'annyang';\n\nexport default {\n  data() {\n    return {\n      recognizedText: '',\n      imgList: []\n    };\n  },\n  methods: {\n    startRecognition() {\n      if (annyang) {\n        this.loadImages()\n        annyang.start({ autoRestart: false, continuous: false });\n        // 设置识别语言为中文\n        annyang.setLanguage('zh-CN');\n\n        annyang.addCallback('result', (phrases) => {\n          console.log('phrases', phrases)\n          if (phrases && phrases.length > 0) {\n            this.recognizedText = phrases[0];\n          }\n        });\n      } else {\n        this.recognizedText = 'Web Speech API not supported';\n      }\n    },\n    loadImages() {\n      const folderPath = require.context('../assets/images/result', false, /\\.(png|jpe?g|gif|svg)$/);\n      const images = folderPath.keys().map((key) => folderPath(key));\n      this.imgList = images;\n      // // 本地静态文件夹路径\n      // const folderPath = '../assets/result-list';\n      // // 使用require.context来动态加载文件夹下的所有图片\n      // const images = require.context(folderPath, false, /\\.(png|jpe?g|gif|svg)$/);\n      // // 遍历加载图片并将路径添加到images数组\n      // images.keys().forEach((key) => {\n      //   const imagePath = images(key);\n      //   this.imgList.push(imagePath);\n      // })\n      this.observeImages()\n    },\n    observeImages() {\n      const images = Array.from(document.querySelectorAll('.lazy-image'));\n\n      const observer = new IntersectionObserver(\n        (entries) => {\n          entries.forEach((entry) => {\n            if (entry.isIntersecting) {\n              const imageIndex = parseInt(entry.target.dataset.index);\n              this.imgList[imageIndex].isVisible = true;\n            }\n          });\n        },\n        {\n          rootMargin: '0px',\n          threshold: 0.1,\n        }\n      );\n\n      images.forEach(image => {\n        observer.observe(image);\n        this.imgList.push({\n          src: '',\n          alt: '',\n          isVisible: false,\n        });\n      });\n    },\n    imageLoaded(index) {\n      const image = this.imgList[index];\n      image.src = image.originalSrc;\n      image.alt = image.originalAlt;\n    },\n  },\n  beforeDestroy() {\n    if (annyang) {\n      annyang.abort();\n    }\n  },\n};\n</script>\n<style scoped>\n  .lazy-image {\n    opacity: 0;\n    transition: opacity 0.3s;\n  }\n  .lazy-image.is-visible {\n    opacity: 1;\n  }\n  .img-size {\n    width: 500px;\n    object-fit: contain;\n  }\n</style>\n"]}]}